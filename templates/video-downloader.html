{% extends 'layout.html' %}
{% block main %}
        <h1 class="visually-hidden">You Tube Downloader</h1>
      
        <div class="px-4 py-5 my-5 text-center">
          <h1 class="display-5 fw-bold">Video Downloader!</h1>
          <form 
            action="download/"
            id="download-form"
            method="get" 
            class="col-lg-6 mx-auto"
          >
            <p class="lead mb-4 mt-4">
              <input
                type="text"
                class="text-center form-control rounded-3 pt-2 pb-2"
                id="floatingInput"
                name="url"
                placeholder="Insira o link..."
                class="fieldBox w-100"
                required
              />
            </p>
            <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
              <button type="submit" disabled id="submitBtn"  class="btn btn-primary btn-lg px-4">
                <svg viewBox="25 25 50 50" id="loading-circle" class="d-none">
                  <circle r="20" cy="50" cx="50"></circle>
                </svg>
                <span>
                  Baixar em v√≠deo
                </span>
              </button>
            </div>
          </form>
        </div>
        <div class="b-example-divider"></div>
        <script>
          function verifyIfItsValid(text){
            if(
              text.slice(0,32)==="https://www.youtube.com/watch?v=" || 
              text.slice(0, 28)==="https://youtube.com/watch?v=" ||
              text.slice(0, 17)==="https://youtu.be/"
            ){
              document.getElementById("submitBtn").removeAttribute("disabled")
            } else{
              document.getElementById("submitBtn").setAttribute("disabled", "true")
            }
          }
          verifyIfItsValid(document.getElementById("floatingInput").value)
          document.getElementById("floatingInput").addEventListener("input",(e)=>{
            verifyIfItsValid(e.target.value)
          })
          document.getElementById("submitBtn").addEventListener("click", ()=>{
              document.getElementById("loading-circle").classList.remove("d-none")
              setTimeout(() =>document.getElementById("submitBtn").setAttribute("disabled", "true"), 200);
          })
          
        </script>

{% endblock %}
